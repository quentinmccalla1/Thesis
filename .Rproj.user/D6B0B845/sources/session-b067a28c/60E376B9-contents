---
title: "Seedling Statistics"
output: html_document
date: "2024-09-04"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Stats

```{r}
library(dplyr)
#install.packages("ggplot2")
remove(HDR)
```

All seedling

```{r}
BRAP1row <- read_csv("BRAP1ROW.csv")
Childs1row <- read_csv("Childs1ROW.csv")


BRAP1row <- na.omit(BRAP1row)
Childs1row <- na.omit(Childs1row)
```

Summary Stats

```{r}
#Height and Diameter means
BeasleyMeans <- colMeans(BRAP1row)
ChildsMeans <-colMeans(Childs1row)
```

Change over time

Beasley

```{r}
#Diameter Beasley
((BeasleyMeans[3]-BeasleyMeans[1])/BeasleyMeans[1])*100
#Height Beasley
((BeasleyMeans[4]-BeasleyMeans[2])/BeasleyMeans[2])*100


```

Childs

```{r}
#print(ChildsMeans)

#Diamter Childs
((ChildsMeans[3]-ChildsMeans[1])/ChildsMeans[1])*100
#Height Childs
((ChildsMeans[4]-ChildsMeans[2])/ChildsMeans[2])*100

```

Ratios

height/diameter ratio

```{r}

#Beasley 2023 HDR

# Define the function to calculate HDR (Height / Diameter)
HDR2023BRAP <- function(height, diameter) {
  result <- height / diameter
  return(result)
}

# Use mutate to add the new column, passing the correct columns to the function
BRAP1row <- BRAP1row %>%
  mutate(HDR2023 = HDR2023BRAP(HeightBRAP2023, DiameterBRAP2024))



#Beasley 2024 HDR
HDR2024BRAP <- function(BRAP1row){
  result <- BRAP1row$HeightBRAP2024 / BRAP1row$DiameterBRAP2024
}
# Use mutate to add the new column, passing the correct columns to the function
BRAP1row <- BRAP1row %>%
  mutate(HDR2024 = HDR2023BRAP(HeightBRAP2024, DiameterBRAP2024))


```

Childs HDR

```{r}
#Childs 2023 HDR
HDR2023Childs <- function(height, diameter) {
  result <- height / diameter
  return(result)
}

Childs1row <- Childs1row %>%
  mutate(HDR2023 = HDR2023Childs(HeightCHD.2023, DiameterCHD2022))

#Childs 2024 HDR
HDR2024Childs <- function(height, diameter) {
  result <- height / diameter
  return(result)
}

Childs1row <- Childs1row %>%
  mutate(HDR2024 = HDR2023Childs(HeightCHD2024, DiameterCHD2023))


```

# Plots

Clean data

```{r}
# Extract the columns you need
ChildsHDR2023 <- Childs1row[, 5]
ChildsHDR2024 <- Childs1row[, 6]
BRAPHDR2023 <- BRAP1row[,5]
BRAPHDR2024 <- BRAP1row[,6]

#Clean Data Childs
ChildsHDR2024 <- unlist(ChildsHDR2024)
ChildsHDR2024 <- na.omit(ChildsHDR2024)
ChildsHDR2023 <- unlist(ChildsHDR2023)
ChildsHDR2023<- na.omit(ChildsHDR2023

BRAPHDR2023 <- na.omit(BRAPHDR2023)
BRAPHDR2023 <- unlist(BRAPHDR2023)
BRAPHDR2024 <- na.omit(BRAPHDR2024)
BRAPHDR2024 <- unlist(BRAPHDR2024)


```

```{r}

# If it's a list, extract the numeric vector

# Create the histogram
hist(ChildsHDR2023, 
     main = "Histogram of Childs HDR 2023", 
     xlab = "Values", 
     col = "lightblue", 
     breaks = "Sturges")

```
