"0","# Run ANOVA model"
"0","brap_data$Visit <- as.factor(brap_data$Visit)"
"0","anova_model <- aov(Height ~ Visit, data = brap_data)"
"0","tukey_results <- TukeyHSD(anova_model)"
"0",""
"0","# Function to extract Tukey's results into a data frame"
"0","extract_tukey_results <- function(tukey_result, comparison_name) {"
"0","  if (comparison_name %in% names(tukey_result)) {"
"0","    tukey_df <- as.data.frame(tukey_result[[comparison_name]])"
"0","    if (nrow(tukey_df) > 0) {"
"0","      tukey_df$Comparison <- rownames(tukey_df)"
"0","      rownames(tukey_df) <- NULL"
"0","      colnames(tukey_df) <- c(""Estimate"", ""Lower_CI"", ""Upper_CI"", ""P_Value"", ""Comparison"")"
"0","      return(tukey_df[, c(""Comparison"", ""Estimate"", ""Lower_CI"", ""Upper_CI"", ""P_Value"")])"
"0","    }"
"0","  }"
"0","  return(data.frame(Comparison = NA, Estimate = NA, Lower_CI = NA, Upper_CI = NA, P_Value = NA))"
"0","}"
"0","# Extract Tukey results for the interaction term"
"0","tukey_results_interaction_df <- extract_tukey_results(tukey_results, ""Variable:Date"")"
"0","selected_rows <- c(3, 6, 11, 14, 18, 21, 24, 29, 33)"
"0","selected_data <- data.frame()"
"0","# Loop through the selected rows and add them to the data frame"
"0","for (row in selected_rows) {"
"0","  if (row <= nrow(tukey_results_interaction_df)) {"
"0","    selected_data <- rbind(selected_data, tukey_results_interaction_df[row, ])"
"0","  }"
"0","}"
"0",""
"0","# Generate the kable table"
"0","selected_data %>%"
"0","  kable(""html"", caption = ""Selected Rows from Tukey Test"") %>%"
"0","  kable_styling(full_width = FALSE) %>%"
"0","  row_spec(which(selected_data$P_Value < 0.05), background = ""lightgreen"")"
