"0","# Initialize an empty list to store formatted Tukey results"
"0","formatted_results <- list()"
"0",""
"0","# Loop through each variable's Tukey results"
"0","for (var in variables) {"
"0","  if (!is.null(tukey_results[[var]])) {"
"0","    # Extract Tukey results for Visit comparisons"
"0","    tukey_data <- as.data.frame(tukey_results[[var]]$Visit)"
"0","    tukey_data$Comparison <- rownames(tukey_data)"
"0","    rownames(tukey_data) <- NULL"
"0","    tukey_data$Variable <- var"
"0","    # Reorder columns"
"0","    tukey_data <- tukey_data %>%"
"0","      select(Variable, Comparison, diff, lwr, upr, `p adj`) %>%"
"0","      rename(Mean_Diff = diff, Lower_CI = lwr, Upper_CI = upr, P_Value = `p adj`)"
"0","    # Append to formatted results"
"0","    formatted_results[[var]] <- tukey_data"
"0","  }"
"0","}"
"0",""
"0","# Combine all results into one data frame"
"0","final_results <- bind_rows(formatted_results)"
"0","# Display as a styled table"
"0","final_results %>%"
"0","  kable(""html"", caption = ""Tukey's HSD Results for BRAP"") %>%"
"0","  kable_styling(full_width = FALSE) %>%"
"0","  row_spec(which(final_results$P_Value < 0.05), background = ""lightgreen"")"
