---
title: "Min age"
output: html_document
date: "2024-09-12"
---
```{r}
library(dplR)
```


```{r}
DendroMerge <- read_csv("DendroMergeforR.csv")

DendroMerge <- DendroMerge[,-8]



```




Age vs size plot
```{r}
ggplot(DendroMerge, aes(x = PithHand, y = `Diameter (CM)`, color= ID2)) +
  labs( x= "Pith Year", y = "Diameter (cm)", title = "Diameter vs Pith Date") +
  geom_point(shape=18, size= 3)+
  geom_smooth( method = "lm", se = FALSE, size = 1.5)+
  scale_y_continuous(
    limits = c(0,100)
  ) +
scale_x_continuous(
  limits = c(1985,2020)
)
```


Age vs Size correlation
```{r}
model <- lm(DendroMerge$`Diameter (CM)` ~ DendroMerge$PithHand, data = DendroMerge)

summary(model)


```


```{r}
DendroMerge$InnerRing <- as.numeric(DendroMerge$InnerRing)
summary(DendroMerge$InnerRing)
```

Age bar graph


```{r}
DendroSiteAges <- read_csv("DendroSiteAges.csv")

DendroSiteAges <- DendroSiteAges %>%
  arrange(Year) %>%  # Make sure data is ordered by year
  mutate(CumulativeInnerRing = cumsum(All))

# Bar plot with specified y-values
ggplot(data = DendroSiteAges, aes(x=Year, y = All)) +
    geom_line(aes(y = CumulativeInnerRing), color = "darkblue", size = 1) +  # Cumulative line
  geom_col() +
   scale_y_continuous(
    name = "Inner Ring Count",                                               # Primary y-axis label
    sec.axis = sec_axis(~ ., name = "Cumulative Inner Ring Count")          # Secondary y-axis label
  ) +
  labs(x = "Year", y = "Count", title = "Inner Ring Tree Ring Count") +
  theme_minimal()


```

```{r}
# Load necessary libraries
library(ggplot2)
library(gridExtra)

# Create two example plots
plot1 <- ggplot(DendroSiteAges, aes(x = Year, y = All)) + 
  geom_col(fill = "skyblue") +
  labs(title = "Bar Plot of All Counts")

plot2 <- ggplot(DendroSiteAges, aes(x = Year, y = CumulativeInnerRing)) + 
  geom_line(color = "darkblue", size = 1) +
  labs(title = "Line Plot of Cumulative Inner Ring")

# Combine the plots
grid.arrange(plot1, plot2, ncol = 2)  # ncol specifies the number of columns

```






